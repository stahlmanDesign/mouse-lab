<!DOCTYPE html>
<html lang="fr">

<head>
	<title></title>

	<meta charset="utf-8">

	<!-- bootstrap css file -->
	<link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />

	<!-- fontawesome css file -->
	<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

	<!-- leaflet css -->
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />

	<!-- custom css -->
	<style>
		.cage {
			stroke: #000;
			stroke-miterlimit: 10;
		}

		.cage-breeding {
			fill: #E9242D;
		}

		.cage-weening {
			fill: #FFCD30;
		}

		.text-cageID {
			font-family: 'MyriadPro-Regular';
			font-size: 12px
		}

		svg {
			background: #d2cdb8
		}
	</style>
</head>

<body>

	<div class="container">
		<div id="content">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 800">
				<g class="cage-groups">
					<g>
						<circle class="cage cage-breeding" cx="55" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="149.8" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="244.6" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="339.3" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="434.1" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="528.9" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 498.257 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="623.7" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="718.4" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="813.2" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="908" cy="113" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 158)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="55" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="149.8" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="244.6" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="339.3" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="434.1" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="528.9" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 498.257 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="623.7" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="718.4" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="813.2" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="908" cy="213" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 258)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="55" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="149.8" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="244.6" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="339.3" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="434.1" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="528.9" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 498.257 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="623.7" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="718.4" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="813.2" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="908" cy="313" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 358)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="55" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="149.8" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-breeding" cx="244.6" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="339.3" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="434.1" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="528.9" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 498.257 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="623.7" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="718.4" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="813.2" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="908" cy="413" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 458)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="55" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="149.8" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="244.6" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="339.3" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="434.1" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="528.9" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 498.257 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="623.7" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="718.4" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="813.2" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="908" cy="513" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 558)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="55" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="149.8" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="244.6" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="339.3" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="434.1" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="528.9" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 498.257 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="623.7" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="718.4" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="813.2" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="908" cy="613" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 658)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="55" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 24.3682 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="149.8" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 119.1459 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="244.6" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 213.9237 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="339.3" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 308.7015 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="434.1" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 403.4793 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="528.9" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 498.257 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="623.7" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 593.0349 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="718.4" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 687.8126 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="813.2" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 782.5904 758)" class="text-cageID">ARhomoBC1</text>
					</g>
					<g>
						<circle class="cage cage-weening" cx="908" cy="713" r="27" />
						<text transform="matrix(1 0 0 1 877.3682 758)" class="text-cageID">ARhomoBC1</text>
					</g>
				</g>
				<g>
					<text transform="matrix(1 0 0 1 56 50.0439)" class="text-cageID">Breeding</text>
					<rect x="27" y="40" class="cage cage-breeding" width="18" height="18" />
				</g>
				<g>
					<text transform="matrix(1 0 0 1 184 50.0439)" class="text-cageID">Weening</text>
					<rect x="155" y="40" class="cage cage-weening" width="18" height="18" />
				</g>
			</svg>
		</div>
	</div>
	<!-- reload browser when files change -->
	<script type="text/javascript" src="http://livejs.com/live.js"></script>

	<!-- jquery.min.js  -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

	<!-- underscore javascript utility libirary -->
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>

	<!-- bootstrap js file -->
	<script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

	<!-- leaflet js -->
	<script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>

	<!-- d3 -->
	<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>

	<!-- queue for deferring loaded data -->
	<script src="http://d3js.org/queue.v1.min.js"></script>

	<!-- Tabletop for reading from Google Spreadsheet -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.3/tabletop.min.js"></script>

	<script type="text/javascript">
		var svg = d3.select("svg")
		var circles = svg.selectAll(".cage")
		var groups = svg.selectAll(".cage-groups g")
		var texts = svg.selectAll(".cage-groups text");



		setInterval(function() {
			var randomInt = _.sample(_.range(90))
			var rndData = _.sample(_.range(90), randomInt) // [63, 17, 1, 38, 79, 75, 56, 45, 0, 51, …] (70)
			drawCircles(rndData)
			drawGroups(rndData)
			drawTexts(rndData)
		}, 2500)

		function drawTexts(data) {

			texts.data(data).enter().append("text")
			texts.attr("fill", function(d) {
					return _.sample(["red", "green", "yellow", "blue", "gray"]);
				})
				.text(function(d, i) {
					return d
				})
				.attr("fill-opacity", 1)
				// take whatever is left over in the selection after the data length has reached its end, and affect the object. Remove will destory coordinates that you may want if you update with more data
			texts.data(data).exit().transition().attr("fill-opacity", 0) //.remove(); // exit cannot be chained to enter; also must tell which data join

		}

		function drawGroups(data) {
			groups.data(data)
				.enter().append("g") // add circles if not enough

			groups.transition() // apply changes to all
				.attr("transform", "translate(" + _.sample(_.range(10)) + "," + _.sample(_.range(10)) + ")")

			// take whatever is left over in the selection after the data length has reached its end, and affect the object. Remove will destory coordinates that you may want if you update with more data
			groups.data(data).exit().transition().attr("color", function(d) {
					return _.sample(["red", "green", "yellow", "blue", "gray"]);
				}) //.remove(); // exit cannot be chained to enter; also must tell which data join

		}

		function drawCircles(data) {
			circles.data(data)
				.enter().append("circle") // add circles if not enough

			circles.transition() // apply changes to all
				.attr("cx", function(d, i) {
					var cx = d3.select(this).attr("cx");
					var randomInt = _.sample(_.range(90))
					return (cx * 1) // +_.sample(_.range(90))-_.sample(_.range(90)) ;
				})
				.attr("cy", function(d, i) {
					var cy = d3.select(this).attr("cy");
					return (cy * 1) //+ _.sample(_.range(30))
				})
				.attr("r", function(d) {
					return d / 3;
				})

			// take whatever is left over in the selection after the data length has reached its end, and affect the object. Remove will destory coordinates that you may want if you update with more data
			circles.data(data).exit().transition().attr("r", function(d) {
					return 0;
				}) //.remove(); // exit cannot be chained to enter; also must tell which data join

		}
	</script>

</body>

</html>
